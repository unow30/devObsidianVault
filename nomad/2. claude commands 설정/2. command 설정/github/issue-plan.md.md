## Persona
이 작업은 백엔드(`backend.md`), 프론트엔드(`frontend.md`), Git 관리자(`git.md`) 페르소나의 협업이 필요합니다.
사용자가 제공하는 `$ARGUMENT`가 GitHub 이슈 번호인지 확인하고 이를 해결하기 위한 계획을 수립합니다.

## 사용 방법
GitHub 이슈 번호를 입력하면 이슈를 자동으로 가져와 분석하고, 해결을 위한 상세한 실행 계획을 수립합니다.

## 프롬프트

다음 단계를 따라 GitHub 이슈를 분석하고 해결 계획을 수립해주세요:

---

## Step 1: 이슈 정보 가져오기

**작업:**
1. `gh issue view $ARGUMENT --json title,body,labels,assignees,comments --repo $(gh repo view --json nameWithOwner -q .nameWithOwner)` 명령어로 이슈 상세 정보 가져오기
2. 이슈가 존재하지 않으면 에러 메시지와 함께 종료
3. 이슈 정보를 다음 형식으로 정리하여 출력:

```
📋 이슈 #$ARGUMENT: [제목]

[레이블] [담당자]

**설명:**
[본문 내용]

**주요 코멘트:**
- [중요한 코멘트 요약]
```

---

## Step 2: 문제 이해 및 범위 파악

**다음을 분석하여 출력:**

### 문제 정의
- **핵심 문제**: 이슈가 설명하는 핵심 문제 1-2문장으로 요약
- **발생 조건**: 문제가 발생하는 상황이나 재현 단계
- **영향 범위**: 어떤 사용자/기능에 영향을 주는지
- **우선순위 판단**: 레이블과 내용을 바탕으로 긴급도 평가 (Critical/High/Medium/Low)

### 관련 코드 탐색 전략
이슈 내용에서 언급된 다음 요소를 식별:
- 파일명, 함수명, 컴포넌트명
- 에러 메시지 키워드
- 기능 영역 (예: 인증, 결제, UI 등)

---

## Step 3: 코드베이스 탐색

**작업:**
1. Step 2에서 식별한 키워드로 코드 검색 수행
   - `Grep` 도구 사용하여 관련 파일 찾기
   - `Glob` 도구로 패턴 매칭
2. 최소 3-5개 핵심 파일 읽기 (`Read` 도구)
3. 관련 코드 위치 파악 후 다음 형식으로 정리:

```
🔍 관련 코드 위치

1. **파일경로:라인번호** - 역할 설명
2. **파일경로:라인번호** - 역할 설명
...

📌 핵심 발견사항:
- [중요한 코드 패턴이나 문제점]
```

---

## Step 4: 근본 원인 분석

**다음을 분석하여 출력:**

### 원인 분석
- **직접 원인**: 코드에서 발견한 직접적인 버그나 문제
- **근본 원인**: 왜 이 문제가 발생했는지 (설계 결함, 엣지 케이스 미처리 등)
- **관련 코드 흐름**: 문제가 발생하는 코드 실행 경로

### 제약 조건 및 고려사항
- **하위 호환성**: 기존 API나 동작 유지 필요 여부
- **의존성**: 다른 기능/모듈에 미치는 영향
- **성능**: 해결 방법이 성능에 미칠 영향
- **보안**: 보안 취약점 여부

---

## Step 5: 해결 방안 설계

**여러 접근법이 있다면 2-3가지 제시하고, 각각 장단점 비교:**

### 방안 1: [접근법 이름] (권장/대안)
**설명**: 어떻게 해결하는지 2-3문장
**장점**:
- 장점 1
- 장점 2
**단점**:
- 단점 1
**예상 작업 시간**: X시간

### 방안 2: [접근법 이름] (대안)
**설명**: ...
**장점**: ...
**단점**: ...
**예상 작업 시간**: X시간

**💡 권장 방안**: 방안 X - [이유]

---

## Step 6: 상세 구현 계획

**권장 방안을 기준으로 작업 분해:**

### 구현 단계

#### 1단계: [작업명]
- **작업 내용**: 구체적인 변경 사항
- **수정 파일**: `파일경로:예상라인`
- **예상 시간**: X시간
- **검증 방법**: 어떻게 확인할지

#### 2단계: [작업명]
- **작업 내용**: ...
- **수정 파일**: ...
- **예상 시간**: X시간
- **검증 방법**: ...

#### N단계: 테스트 및 검증
- **단위 테스트**: 추가/수정할 테스트 목록
- **통합 테스트**: E2E 또는 시나리오 테스트
- **수동 테스트**: 재현 단계 재확인

---

## Step 7: 위험 요소 및 완료 조건

### 🚨 잠재적 위험 요소
1. **위험 1**: [설명] - 대응 방안: [...]
2. **위험 2**: [설명] - 대응 방안: [...]

### ✅ 완료 조건 (Definition of Done)
- [ ] 이슈에 명시된 문제 재현 → 해결 확인
- [ ] 기존 테스트 모두 통과
- [ ] 새로운 테스트 추가 (해당 시)
- [ ] 코드 리뷰 준비 (주석, 문서화)
- [ ] 관련 문서 업데이트 (README, API 문서 등)
- [ ] 이슈 코멘트에 해결 내용 요약

### 📊 테스트 계획
**재현 시나리오**:
1. [이슈 재현 단계]
2. ...

**수정 후 검증**:
1. [검증 단계]
2. ...

---

## Step 8: 사용자 승인 요청

**다음과 같이 요약하여 제시:**

```
🎯 해결 계획 요약

**이슈**: #$ARGUMENT - [제목]
**우선순위**: [High/Medium/Low]
**권장 방안**: [방안명]
**예상 소요 시간**: X시간
**수정 파일 수**: N개

주요 변경사항:
1. [핵심 변경 1]
2. [핵심 변경 2]

위험 요소:
- [주요 위험 1개만]

이 계획으로 진행하시겠습니까?
```

**사용자에게 질문:**
- ✅ 이 계획대로 진행
- 🔄 다른 방안 검토 필요
- ❓ 추가 질문/수정 요청

---

## 추가 지침

### 계획 수립 시 원칙
1. **증거 기반**: 추측 대신 실제 코드를 읽고 분석
2. **최소 변경**: 이슈 해결에 필요한 최소한의 수정만 계획
3. **테스트 우선**: 모든 변경에 대한 검증 방법 명시
4. **명확한 단계**: 각 단계가 독립적으로 실행/검증 가능하도록

### 불확실성 처리
- 코드 탐색 후에도 원인이 불명확하면 "추가 조사 필요" 명시
- 이슈 설명이 불충분하면 사용자에게 재현 단계 요청
- 여러 방안이 동등하면 모두 제시하고 사용자 선택 요청

### 출력 형식
- 이모지 사용하여 가독성 향상 (📋 🔍 🚨 ✅ 등)
- 코드 위치는 반드시 `파일경로:라인번호` 형식
- 체크리스트는 마크다운 `- [ ]` 형식

---

이 프롬프트는 자동으로 이슈를 분석하고 실행 가능한 계획을 수립하여, 사용자가 승인 후 바로 구현을 시작할 수 있도록 돕습니다.
